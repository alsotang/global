<!DOCTYPE html>
<html>
  <head>
    <meta charset="utf-8" />
    <title>铜锣湾计划</title>
    
    <!-- 最新 Bootstrap 核心 CSS 文件 -->
    <link rel="stylesheet" href="http://cdn.bootcss.com/twitter-bootstrap/3.0.3/css/bootstrap.min.css">
    <!-- jQuery文件。务必在bootstrap.min.js 之前引入 -->
    <script src="http://cdn.bootcss.com/jquery/1.10.2/jquery.min.js"></script>

    <!-- 最新的 Bootstrap 核心 JavaScript 文件 -->
    <script src="http://cdn.bootcss.com/twitter-bootstrap/3.0.3/js/bootstrap.min.js"></script>
    <style>
      body{
        background: url(http://gtms01.alicdn.com/tps/i1/T1cskEFb8hXXc1h6Ua-2560-1600.jpg) no-repeat fixed center;
        font-family: "Lato", Helvetica, Arial, sans-serif;
        font-size: 14px;
        line-height: 20px;
        color: #414141;
      }
      body,div,p,ul,li,span{
        margin: 0;
        padding: 0;
        border: 0 none;
      }
      #wrapper{
        width: 1000px;
        height: auto;
        margin: 0 auto -40%;
        overflow: hidden;
      }
      .container{
        margin-top: 80px;
        margin-bottom: 40px;
        width: 1000px;
        height: 1250px;
        -webkit-box-shadow:0 0 10px rgba(0, 0, 0, 0.3);
        -moz-box-shadow:0 0 10px rgba(0, 0, 0, 0.3);
        box-shadow:0 0 10px rgba(0, 0, 0, 0.3);
        padding: 0;
      }
      .sidebar{
        width: 0;
        float: left;
        background: url(http://gtms01.alicdn.com/tps/i1/T1h2QFFeplXXXA832r-6-6.png) repeat;
        height: 1250px;


      }
      .sidebar h2{
        color: white;
        text-align: center;
        width: 240px;
        margin: 0;
        padding: 0;
        padding: 40px 0;
        font-size: 20px;
      }
      .sidebar .face-list{
        width: 170px;
        height: auto;
        margin: 0 auto;
        text-align: center;
        list-style: none;
      }
      .sidebar .face-list li{
        color: white;
        height: 80px;
        width: 170px;
        margin-bottom: 60px;
      }
      .sidebar .face-list .face{
        float: left;
        margin-right: 10px;
        width: 80px;
        height: 80px;
        -webkit-border-radius: 50%;
        -moz-border-radius: 50%;
        -ms-border-radius: 50%;
        -o-border-radius: 50%;
        border-radius: 50%;
      }
      .sidebar .face-list li p{
        float: left;
        height: 60px;
        padding: 5px 0;
      }
      .sidebar .face-list li p span{
        display: block;
        margin-bottom: 5px;
      }
      .content{
        width: 1000px;
        float: left;
        height: 1250px;
        background: white;
      }
      .page-header{
        background-color:#24c5cf;
        border-color:white;
        padding: 20px;
        margin: 0;
        border-bottom: 1px solid #eee;
      }
      .page-header h1{
        color:white;
        text-shadow: 0 1px 0 rgba(0, 0, 0, 0.25);
        font-size: 20px;
      }
      .page-form{
        padding: 5px;
        width: 1000px;
      }
      .form-horizontal{
        border: 1px solid #eaeaea;
        padding-top: 10px;
        border-top: 0 none;
      }
      .form-horizontal .form-group{
        margin-left: 0;
        margin-right: 0;
      }
      .form-horizontal .form-group .checkbox,.form-horizontal .form-group .radio{
        margin-left: 40px;
        margin-bottom: 5px;
        float: left;
      }
      .form-horizontal .form-group .radio{

      }
      .form-horizontal .divider{
        height: 2px;
        border-bottom: 1px solid #eee;
        width: 720px;
        margin: 10px auto;
      }
      .form-horizontal h3{
        font-size: 14px;
        margin-left:10px;
        display: block;
        margin-bottom: 10px;
      }
      .form-horizontal h4{
        font-size: 14px;
        margin-left: 10px;
        float: left;
      }
      .alg-box{
        border: 1px solid #eaeaea;
        float: left;
        width: 235px;
        height: 160px;
        margin-left: 10px;
        padding: 0 10px;
      }
      .alg-select{
        width: 215px;
        height: 150px;
        display: block;
        border: 1px solid #eaeaea;
      }
      .alg-box button{
        margin: 10px auto;
        display: block;
      }
    </style>
  </head>
  <body>
    <div id="wrapper">
      <div class="container">
        <div class="sidebar">
          <h2>Team Member</h2>
          <ul class="face-list">
            <li>
                <img class="face" src="http://wwc.taobaocdn.com/avatar/getAvatar.do?userNick=%B0%D7%C2%DD&width=80&height=80&type=sns" alt="">
              <p>
                <span>白螺</span>
                <span>BI & PD</span>
                <a target="_blank" href="http://www.taobao.com/webww/ww.php?ver=3&touid=%E7%99%BD%E8%9E%BA&siteid=cntaobao&status=1&charset=utf-8"><img border="0" src="http://amos.alicdn.com/online.aw?v=2&uid=%E7%99%BD%E8%9E%BA&site=cntaobao&s=1&charset=utf-8" alt="点这里给我发消息" /></a>
              </p>
            </li>
            <li>
                <img class="face" src="http://wwc.taobaocdn.com/avatar/getAvatar.do?userNick=%BB%B3%D2%BB&width=80&height=80&type=sns" alt="">
              <p>
                <span>怀一</span>
                <span>PM</span>
                <a target="_blank" href="http://www.taobao.com/webww/ww.php?ver=3&touid=%E6%80%80%E4%B8%80&siteid=cntaobao&status=1&charset=utf-8"><img border="0" src="http://amos.alicdn.com/online.aw?v=2&uid=%E6%80%80%E4%B8%80&site=cntaobao&s=1&charset=utf-8" alt="点这里给我发消息" /></a>
              </p>
            </li>
            <li>
                <img class="face" src="http://wwc.taobaocdn.com/avatar/getAvatar.do?userNick=%E5%A5%CF%AA&width=80&height=80&type=sns" alt="">
              <p>
                <span>濂溪</span>
                <span>Dev</span>
                <a target="_blank" href="http://www.taobao.com/webww/ww.php?ver=3&touid=%E6%80%80%E4%B8%80&siteid=cntaobao&status=1&charset=utf-8"><img border="0" src="http://amos.alicdn.com/online.aw?v=2&uid=%E6%80%80%E4%B8%80&site=cntaobao&s=1&charset=utf-8" alt="点这里给我发消息" /></a>
              </p>
            </li>
            <li>
                <img class="face" src="http://wwc.taobaocdn.com/avatar/getAvatar.do?userNick=%D4%C6%F0%D8&width=80&height=80&type=sns" alt="">
              <p>
                <span>云鹭</span>
                <span>Tester</span>
                <a target="_blank" href="http://www.taobao.com/webww/ww.php?ver=3&touid=%E6%80%80%E4%B8%80&siteid=cntaobao&status=1&charset=utf-8"><img border="0" src="http://amos.alicdn.com/online.aw?v=2&uid=%E6%80%80%E4%B8%80&site=cntaobao&s=1&charset=utf-8" alt="点这里给我发消息" /></a>
              </p>
            </li>
          </ul>
        </div>
        <div class="content">
          <div class="page-header">
            <h1>Causeway Bay Project</h1>
          </div>
          <div class="page-form">
            <div class="form-nav">
              <ul class="nav nav-tabs">
                <li class="active"><a href="#">商品</a></li>
                <li><a href="#">商品店铺</a></li>
                <li><a href="#">标签</a></li>
              </ul>
            </div>
            <div class="form-item">
              <div class="form-item-detail">
                <form class="form-horizontal" role="form">
                  
                  <h3 class="label label-info">基础计算控制区</h3>

                  <div class="form-group">
                    <label for="inputEmail3" class="col-sm-2 control-label">图片质量控制</label>
                    <div class="col-sm-10">
                      <input type="email" class="form-control picscore" id="inputEmail3" placeholder="图片质量控制">
                    </div>
                  </div>

                  <div class="form-group">
                    <label for="inputPassword3" class="col-sm-2 control-label ">买家注册地</label>
                    <div class="col-sm-10">
                      <input type="text" class="form-control areabuyerreg" id="" placeholder="买家注册地">
                    </div>
                  </div>

                  <div class="form-group">
                    <label for="inputPassword3" class="col-sm-2 control-label ">买家收货地</label>
                    <div class="col-sm-10">
                      <input type="text" class="form-control areabuyerlgreceive" id="" placeholder="买家收货地">
                    </div>
                  </div>

                  <div class="form-group">
                    <label for="inputPassword3" class="col-sm-2 control-label">订单所在地</label>
                    <div class="col-sm-10">
                      <input type="text" class="form-control areaorderoccur" id="" placeholder="订单所在地">
                    </div>
                  </div>                  
                  <div class="form-group">
                    <label for="inputPassword3" class="col-sm-2 control-label">卖家id输入</label>
                    <div class="col-sm-10">
                      <input type="text" class="form-control sellerid" id="" placeholder="使用','分隔seller_id">
                    </div>
                  </div>

                  <div class="form-group">
                    <div class="checkbox">
                      <label>
                        <input type="checkbox" value="" class="iswhiteground">
                        是否白底图片
                      </label>
                    </div>
                    <div class="checkbox">
                      <label>
                          <input type="checkbox" value="" class="regulartradeflg">
                          排除非正常行为 (包括恶意注册,刷机点击,炒信,转账交易等)
                      </label> 
                    </div>              
                  </div>

                  <!-- <div class="form-group">
                    <label for="disabledSelect" class="col-sm-2 control-label">图片高度</label>
                    <div class="col-sm-10">
                      <select id="" class="form-control">
                        <option>Disabled select</option>
                      </select>
                    </div>
                  </div> -->

                  <!-- <div class="form-group">
                    <label for="disabledSelect" class="col-sm-2 control-label">图片宽度</label>
                    <div class="col-sm-10">
                      <select id="" class="form-control">
                        <option>Disabled select</option>
                      </select>
                    </div>
                  </div> -->


                  <!-- <div class="form-group">
                    <label for="disabledSelect" class="col-sm-2 control-label">卖家标签提取</label>
                    <div class="col-sm-10">
                      <select id="" class="form-control">
                        <option>Disabled select</option>
                      </select>
                    </div>
                  </div> -->

                  <!-- <div class="form-group">
                    <label for="disabledSelect" class="col-sm-2 control-label">商品标签提取</label>
                    <div class="col-sm-10">
                      <select id="" class="form-control">
                        <option>Disabled select</option>
                      </select>
                    </div>
                  </div> -->

                  <div class="divider"></div>

                  <h3 class="label label-info">品类选择区</h3>

                  <div class="form-group">
                    <label for="" class="col-sm-2 control-label">一级类目ID</label>
                    <div class="col-sm-10">
                      <input type="text" class="form-control categorylevel1" id="" placeholder="使用','分隔seller_id">
                    </div>
                  </div>

                  <div class="form-group">
                    <label for="" class="col-sm-2 control-label">二级类目ID</label>
                    <div class="col-sm-10">
                      <input type="text" class="form-control categorylevel2" id="" placeholder="使用','分隔seller_id">
                    </div>
                  </div>

                  <div class="form-group">
                    <label for="" class="col-sm-2 control-label">三级类目ID</label>
                    <div class="col-sm-10">
                      <input type="text" class="form-control categoryleaf" id="" placeholder="使用','分隔seller_id">
                    </div>
                  </div>

                  <div class="form-group">
                    <label for="" class="col-sm-2 control-label">关键词筛选</label>
                    <div class="col-sm-10">
                      <input type="text" class="form-control keyword" id="" placeholder="使用','分隔seller_id">
                    </div>
                  </div>

                  <div class="form-group">
                    <div class="checkbox">
                      <label>
                        <input type="checkbox" value="" class="isexemptionpostage">
                        是否国内包邮
                      </label>
                    </div>            
                  </div>

                  <div class="divider"></div>

                  <h3 class="label label-info">算法控制区</h3>

                  <div class="form-group">
                    <div class="alg-box">
                      <div class="alg-box-hd">
                        <label for="">分桶1</label> <input type="checkbox" class="selectedsubbarrels" value="subBarrels_1"/> 
                      </div>
                      <div class="alg-box-bd">
                        <p>
                          <label for="">算法类别：</label>
                          <select name="" id="" class="alg-type">
                          </select>
                        </p>
                        <label for="">算法类型：</label>
                        <select class="dropLang">
                         
                        </select>
                        <label for="">算法排序：</label>
                        <select name="" class="dropFrame">
                     
                        </select>
                      </div>
                      <button type="button" class="btn btn-sm btn-success btn-preview">预览</button>
                    </div>
                    <div class="alg-box">
                      <div class="alg-box-hd">
                        <label for="">分桶2</label> <input type="checkbox" class="selectedsubbarrels" value="subBarrels_2"/> 
                      </div>
                      <div class="alg-box-bd">
                        <p>
                          <label for="">算法类别：</label>
                          <select name="" id="" class="alg-type">
                          </select>
                        </p>
                        <label for="">算法类型：</label>
                        <select class="dropLang">
                        
                        </select>
                        <label for="">算法排序：</label>
                        <select name="" class="dropFrame">
              
                        </select>
                      </div>
                      <button type="button" class="btn btn-sm btn-success btn-preview">预览</button>
                    </div>
                    <div class="alg-box">
                      <div class="alg-box-hd">
                        <label for="">分桶3</label> <input type="checkbox" class="selectedsubbarrels" value="subBarrels_3" /> 
                      </div>
                      <div class="alg-box-bd">
                        <p>
                          <label for="">算法类别：</label>
                          <select name="" id="" class="alg-type">
                          </select>
                        </p>
                        
                        <label for="">算法类型：</label>
                        <select class="dropLang">
                      
                        </select>
                        <label for="">算法排序：</label>
                        <select name="" class="dropFrame">
                   
                        </select>
                      </div>
                      <button type="button" class="btn btn-sm btn-success btn-preview">预览</button>
                    </div>
                    <div class="alg-box">
                      <div class="alg-box-hd">
                        <label for="">分桶4</label> <input type="checkbox" class="selectedsubbarrels" value="subBarrels_4"/> 
                      </div>
                      <div class="alg-box-bd">
                        <p>
                          <label for="">算法类别：</label>
                          <select name="" id="" class="alg-type">
                          </select>
                        </p>
                        <label for="">算法类型：</label>
                        <select class="dropLang">
                        </select>
                        <label for="">算法排序：</label>
                        <select name="" class="dropFrame">
                            
                        </select>
                      </div>
                      <button type="button" class="btn btn-sm btn-success btn-preview">预览</button>
                    </div>                  
                  </div>
                  
                  <script>

                    var app;

                    app = (function(){

                        var application = {

                          init: function(){
                            this.initSelect();
                            this.initPage();
                            this.bind();
                          },
                          initSelect: function() {

                            var eDropLangChange = function(){  

                              var selectedValue = $(this).children("option:selected").attr("data-id");

                              var self_parent = $(this).parent();

                              
                              $(self_parent).children('.dropFrame').children("span").each(function(){  
                                $(this).children().clone().replaceAll($(this));   
                              });  
                              if(parseInt(selectedValue) != 0){  
                                $(self_parent).children('.dropFrame').children("option[parentid!='" + selectedValue + "'][value!='0']").each(function(){   
                                  $(this).wrap("<span style='display:none'></span>");  
                                });   
                              }  
                            };

                            var eDropFrameChange = function(){ 
                              var self_parent = $(this).parent();
                              var parentid = $(this).children("option:selected").attr("parentid");
                              $(self_parent).children(".dropLang").find("[data-id|="+ parentid +"]").prop("selected",true);                       
                            };

                            $(".dropLang").unbind("change", eDropLangChange).bind("change", eDropLangChange);   
                            $(".dropFrame").unbind("change", eDropFrameChange).bind("change", eDropFrameChange); 


                          },

                          initPage: function() {
                            $.ajax({
                              type : "get",
                              url : "http://10.125.203.32:8080/tboverseas/item/queryList.htm?moduleId=12345",
                              dataType : "jsonp",
                              success: function(data){

                                if(data.operationStatus==1) return;
                                

                                var filterConditions = data.filterConditions;
                                var picScore = filterConditions.picScore; //图片分值
                                var areaBuyerReg = filterConditions.areaBuyerReg; //买家注册地
                                var areaBuyerLgReceive = filterConditions.areaBuyerLgReceive; //买家收货地址
                                var areaOrderOccur = filterConditions.areaOrderOccur; //订单所在地
                                var sellerId = filterConditions.sellerId; //卖家ID
                                var isWhiteGround = filterConditions.isWhiteGround; //是否白底
                                var regularTradeFlg = filterConditions.regularTradeFlg; //是否正常交易
                                var categoryLevel1 = filterConditions.categoryLevel1;
                                var categoryLevel2 = filterConditions.categoryLevel2;
                                var categoryLeaf = filterConditions.categoryLeaf;
                                var keyword = filterConditions.keyword;
                                var isExemptionPostage = filterConditions.isExemptionPostage; //是否包邮

                                $('.picscore').val(picScore);
                                $('.areabuyerreg').val(areaBuyerReg);
                                $('.areabuyerlgreceive').val(areaBuyerLgReceive);
                                $('.areaorderoccur').val(areaOrderOccur);
                                $('.sellerid').val(sellerId);
                                $('.iswhiteground')[0].checked=isWhiteGround ? false : true;
                                $('.regulartradeflg')[0].checked=regularTradeFlg ? true : false;
                                $('.categorylevel1').val(categoryLevel1);
                                $('.categorylevel2').val(categoryLevel2);
                                $('.categoryleaf').val(categoryLeaf);
                                $('.keyword').val(keyword);
                                $('.isexemptionpostage')[0].checked=isExemptionPostage ? false : true;

                              

  

                                var subBarrelsMap = data.filterConditions.subBarrelsMap;
                                var subBarrels_1 = subBarrelsMap.subBarrels_1;
                                var subBarrels_2 = subBarrelsMap.subBarrels_2;
                                var subBarrels_3 = subBarrelsMap.subBarrels_3;
                                var subBarrels_4 = subBarrelsMap.subBarrels_4;

                                var subBarrelsList = [subBarrels_1,subBarrels_2,subBarrels_3,subBarrels_4];

                                
                                $('.alg-box').each(function(index){

                                  self = $(this);

                                  
                                  var subBarrels = subBarrelsList[index];

                                  var selectedSubBarrels = subBarrels.selectedSubBarrels;

                                  //debugger;
                                  self.find('.selectedsubbarrels')[0].checked = selectedSubBarrels;

                                  //二次筛选的条件
                                  self.find('button').attr('data-price',subBarrels.priceRange);
                                  self.find('button').attr('data-sellerlevel',subBarrels.sellerLevel);


                                  //算法类别
                                  var arithmeticTypes = subBarrels.arithmeticTypes;
                                  $.each(arithmeticTypes,function(key,value){
                                    self.find('.alg-type').append('<option value="'+value+'">'+value+'</option>');
                                  });

                                  //算法类型
                                  var arithmetics = subBarrels.arithmetics;
                                  $.each(arithmetics,function(key,value){

                                    dataId = value.substring(0,1);

                                    value = value.slice(2,value.length);

                                    self.find('.dropLang').append('<option value="'+value+'" data-id="'+ dataId +'">'+value+'</option>');
                                  });

                                  //算法排序
                                  var orderString = subBarrels.orderString;
                                  $.each(orderString,function(key,value){

                                    parentId = value.substring(0,1);

                                    value = value.slice(2,value.length);

                                    self.find('.dropFrame').append('<option value="'+value+'" parentid="'+ parentId +'">'+value+'</option>');
                                  });

                                  //记录用户上次的选择
                                  self.find('.alg-type').val(subBarrels.filterStyle);
                                  self.find('.dropLang').val(subBarrels.arithmetic);
                                  
                                  self.find('.dropFrame').val(subBarrels.orderStr);

                                });

                              }
                            });
                          },

                          bind : function(){

                            $('body').on('click','button',function(){


                              var parent = $(this).parent();

                              var subBarrels = parent.find('.selectedsubbarrels').val(),
                                  filterStyle = parent.find('.alg-type').val(),
                                  arithmetic = parent.find('.dropLang').val(),
                                  orderStr = parent.find('.dropFrame').val(),
                                  priceRange = $(this).attr('data-price'),
                                  sellerLevel = $(this).attr('data-sellerlevel');




                              //isWhiteGround 是否白底图片 0/1
                              //regularTradeFlg 是否正常交易 1/0
                              //isExemptionPostage 是否包邮 0/1
                               var causeway = {  id: $.now() ,
                                              picScore: $('.picscore').val(), 
                                              areaBuyerReg: $('.areabuyerreg').val(),
                                              areaBuyerLgReceive :$('.areabuyerlgreceive').val() ,
                                              areaOrderOccur :$('.areaorderoccur').val(), 
                                              sellerId :$('.sellerid').val(),
                                              isWhiteGround : $('.iswhiteground')[0].checked ? 0 : 1,
                                              regularTradeFlg : $('.regulartradeflg')[0].checked ? 1 : 0 ,
                                              categoryLevel1 : $('.categorylevel1').val(),
                                              categoryLevel2 : $('.categorylevel2').val(),
                                              categoryLeaf : $('.categoryleaf').val(),
                                              keyword : $('.keyword').val(),
                                              isExemptionPostage : $('.isexemptionpostage')[0].checked ? 0 : 1,
                                              subBarrels : subBarrels,
                                              filterStyle : filterStyle,
                                              arithmetic : arithmetic,
                                              orderStr : orderStr,
                                              priceRange : priceRange,
                                              sellerLevel : sellerLevel
                                              };

                              localStorage.removeItem("causeway");

                              var item_array = [];

                              item_array.push(causeway);

                              localStorage.setItem("causeway", JSON.stringify(item_array));

                              window.open('./preview.html');

                            });
                          }
                        }

                      return application;

                    })();

                    app.init();

                    

                   
                    
                  </script>



                </form>
              </div>
            </div>
          </div>
        </div>
      </div>
    </div>
  </body>
</html>