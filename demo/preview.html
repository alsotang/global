<!DOCTYPE html>
<html>
  <head>
    <meta charset="utf-8" />
    <title>铜锣湾计划</title>
    <!-- 最新 Bootstrap 核心 CSS 文件 -->
    <link rel="stylesheet" href="http://cdn.bootcss.com/twitter-bootstrap/3.0.3/css/bootstrap.min.css">
    <!-- jQuery文件。务必在bootstrap.min.js 之前引入 -->
    <script src="http://cdn.bootcss.com/jquery/1.10.2/jquery.min.js"></script>

    <!-- 最新的 Bootstrap 核心 JavaScript 文件 -->
    <script src="http://cdn.bootcss.com/twitter-bootstrap/3.0.3/js/bootstrap.min.js"></script>
    <style>
            body{
        background: url(http://gtms01.alicdn.com/tps/i1/T1cskEFb8hXXc1h6Ua-2560-1600.jpg) no-repeat fixed center;
        font-family: "Lato", Helvetica, Arial, sans-serif;
        font-size: 14px;
        line-height: 20px;
        color: #414141;
      }
      body,div,p,ul,li,span{
        margin: 0;
        padding: 0;
        border: 0 none;
      }
      #wrapper{
        width: 1000px;
        height: auto;
        margin: 0 auto -40%;
        overflow: hidden;
      }
      .container{
        margin-top: 80px;
        margin-bottom: 40px;
        width: 1000px;
        height: 1500px;
        -webkit-box-shadow:0 0 10px rgba(0, 0, 0, 0.3);
        -moz-box-shadow:0 0 10px rgba(0, 0, 0, 0.3);
        box-shadow:0 0 10px rgba(0, 0, 0, 0.3);
        padding: 0;
      }
      .sidebar{
        width: 0;
        float: left;
        background: url(http://gtms01.alicdn.com/tps/i1/T1h2QFFeplXXXA832r-6-6.png) repeat;
        height: 1500px;


      }
      .sidebar h2{
        color: white;
        text-align: center;
        width: 240px;
        margin: 0;
        padding: 0;
        padding: 40px 0;
        font-size: 20px;
      }
      .sidebar .face-list{
        width: 170px;
        height: auto;
        margin: 0 auto;
        text-align: center;
        list-style: none;
      }
      .sidebar .face-list li{
        color: white;
        height: 80px;
        width: 170px;
        margin-bottom: 60px;
      }
      .sidebar .face-list .face{
        float: left;
        margin-right: 10px;
        width: 80px;
        height: 80px;
        -webkit-border-radius: 50%;
        -moz-border-radius: 50%;
        -ms-border-radius: 50%;
        -o-border-radius: 50%;
        border-radius: 50%;
      }
      .sidebar .face-list li p{
        float: left;
        height: 60px;
        padding: 5px 0;
      }
      .sidebar .face-list li p span{
        display: block;
        margin-bottom: 5px;
      }
      .content{
        width: 1000px;
        float: left;
        height: auto;
        background: white;
      }
      .page-header{
        background-color:#24c5cf;
        border-color:white;
        padding: 20px;
        margin: 0;
        border-bottom: 1px solid #eee;
      }
      .page-header h1{
        color:white;
        text-shadow: 0 1px 0 rgba(0, 0, 0, 0.25);
        font-size: 20px;
      }
      .page-form{
        padding: 5px;
        width: 1000px;
      }
      .form-horizontal{
        border: 1px solid #eaeaea;
        padding-top: 10px;
        border-top: 0 none;
      }
      .form-horizontal .form-group{
        margin-left: 0;
        margin-right: 0;
      }
      .form-horizontal .form-group .checkbox,.form-horizontal .form-group .radio{
        margin-left: 40px;
        margin-bottom: 5px;
        float: left;
      }
      .form-horizontal .form-group .radio{

      }
      .form-horizontal .divider{
        height: 2px;
        border-bottom: 1px solid #eee;
        width: 970px;
        margin: 10px auto;
      }
      .form-horizontal h3{
        font-size: 14px;
        margin-left:10px;
        display: block;
        margin-bottom: 10px;
      }
      .form-horizontal h4{
        font-size: 14px;
        margin-left: 10px;
        float: left;
      }

      .pre-item{
        width: 1000px;
      }
      .pre-item li{
        float: left;
        margin-top: 10px;
        margin-bottom: 10px;
        margin-right: 10px;
        width: 240px;
        height: 280px;
        overflow: hidden;
        text-align: center;
        position: relative;
      }
      .pre-item li.deleted{
        background-color:black;
        opacity: 0.5;
      }
      .pre-item li a{
        width: 240px;
        height: 280px;
        display: block;
      }
      .pre-item li a:hover{

      }
      .pre-item li img{
        display: inline-block;
        margin: 0 auto;
      }
      .pre-item li span{
        display: inline-block;
        height: 20px;
        width: 240px;
      }
      .pre-item li .mask{
        display: none;
        position: absolute;
        top: 0;
        width: 240px;
        height: 280px;
        background:url(http://gtms02.alicdn.com/tps/i2/T1co9SFupcXXb5Mas3-128-128.png) no-repeat 60px center;
      }
      .pre-item li.deleted .mask,.pre-item li:hover .mask{
        display: block;
      }
      .flip-btn,.save{
        text-align: center;
        padding-bottom: 30px;
      }
      .save{
        padding-top: 30px;
        border-top: 1px solid #eaeaea;
      }
    </style>
  </head>
  <body>
    <div id="wrapper">
      <div class="container">
        <div class="sidebar">
          <h2>Team Member</h2>
          <ul class="face-list">
            <li>
                <img class="face" src="http://wwc.taobaocdn.com/avatar/getAvatar.do?userNick=%B0%D7%C2%DD&width=80&height=80&type=sns" alt="">
              <p>
                <span>白螺</span>
                <span>BI & PD</span>
                <a target="_blank" href="http://www.taobao.com/webww/ww.php?ver=3&touid=%E7%99%BD%E8%9E%BA&siteid=cntaobao&status=1&charset=utf-8"><img border="0" src="http://amos.alicdn.com/online.aw?v=2&uid=%E7%99%BD%E8%9E%BA&site=cntaobao&s=1&charset=utf-8" alt="点这里给我发消息" /></a>
              </p>
            </li>
            <li>
                <img class="face" src="http://wwc.taobaocdn.com/avatar/getAvatar.do?userNick=%BB%B3%D2%BB&width=80&height=80&type=sns" alt="">
              <p>
                <span>怀一</span>
                <span>PM</span>
                <a target="_blank" href="http://www.taobao.com/webww/ww.php?ver=3&touid=%E6%80%80%E4%B8%80&siteid=cntaobao&status=1&charset=utf-8"><img border="0" src="http://amos.alicdn.com/online.aw?v=2&uid=%E6%80%80%E4%B8%80&site=cntaobao&s=1&charset=utf-8" alt="点这里给我发消息" /></a>
              </p>
            </li>
            <li>
                <img class="face" src="http://wwc.taobaocdn.com/avatar/getAvatar.do?userNick=%E5%A5%CF%AA&width=80&height=80&type=sns" alt="">
              <p>
                <span>濂溪</span>
                <span>Dev</span>
                <a target="_blank" href="http://www.taobao.com/webww/ww.php?ver=3&touid=%E6%80%80%E4%B8%80&siteid=cntaobao&status=1&charset=utf-8"><img border="0" src="http://amos.alicdn.com/online.aw?v=2&uid=%E6%80%80%E4%B8%80&site=cntaobao&s=1&charset=utf-8" alt="点这里给我发消息" /></a>
              </p>
            </li>
            <li>
                <img class="face" src="http://wwc.taobaocdn.com/avatar/getAvatar.do?userNick=%D4%C6%F0%D8&width=80&height=80&type=sns" alt="">
              <p>
                <span>云鹭</span>
                <span>Tester</span>
                <a target="_blank" href="http://www.taobao.com/webww/ww.php?ver=3&touid=%E6%80%80%E4%B8%80&siteid=cntaobao&status=1&charset=utf-8"><img border="0" src="http://amos.alicdn.com/online.aw?v=2&uid=%E6%80%80%E4%B8%80&site=cntaobao&s=1&charset=utf-8" alt="点这里给我发消息" /></a>
              </p>
            </li>
          </ul>
        </div>
        <div class="content">
          <div class="page-header">
            <h1>Causeway Bay Project</h1>
          </div>
          <div class="page-form">
            <div class="form-nav">
              <ul class="nav nav-tabs">
                <li class="active"><a href="#">商品</a></li>
                <li><a href="#">商品店铺</a></li>
                <li><a href="#">标签</a></li>
              </ul>
            </div>
            <div class="form-item">
              <div class="form-item-detail">
                <form class="form-horizontal" role="form">
                  
                  <h3 class="label label-info">二次筛选区</h3>

                  <div class="form-group">
                    <label for="inputEmail3" class="col-sm-2 control-label">商品价格下限</label>
                    <div class="col-sm-10">
                      <input type="" class="form-control" id="pricemin" placeholder="商品价格最小值">
                    </div>
                  </div>

                  <div class="form-group">
                    <label for="inputPassword3" class="col-sm-2 control-label">商品价格上限</label>
                    <div class="col-sm-10">
                      <input type="" class="form-control" id="pricemax" placeholder="商品价格最大值">
                    </div>
                  </div>

                  

                  <div class="form-group">
                    <label for="" class="col-sm-2 control-label">卖家星级过滤</label>
                    <div class="col-sm-10">
                      <label class="checkbox-inline">
                        <input type="checkbox" id="inlineCheckbox1" value="1心"> 1心
                      </label>
                      <label class="checkbox-inline">
                        <input type="checkbox" id="inlineCheckbox2" value="2心"> 2心
                      </label>
                      <label class="checkbox-inline">
                        <input type="checkbox" id="inlineCheckbox3" value="3心"> 3心
                      </label>
                      <label class="checkbox-inline">
                        <input type="checkbox" id="inlineCheckbox4" value="4心"> 4心
                      </label>
                      <label class="checkbox-inline">
                        <input type="checkbox" id="inlineCheckbox5" value="5心"> 5心
                      </label>
                      <label class="checkbox-inline">
                        <input type="checkbox" id="inlineCheckbox6" value="1钻"> 1钻
                      </label>
                      <label class="checkbox-inline">
                        <input type="checkbox" id="inlineCheckbox7" value="2钻"> 2钻
                      </label>
                      <label class="checkbox-inline">
                        <input type="checkbox" id="inlineCheckbox8" value="3钻"> 3钻
                      </label>
                      <label class="checkbox-inline">
                        <input type="checkbox" id="inlineCheckbox9" value="4钻"> 4钻
                      </label>
                      <label class="checkbox-inline">
                        <input type="checkbox" id="inlineCheckbox10" value="5钻"> 5钻
                      </label>
                      <label class="checkbox-inline">
                        <input type="checkbox" id="inlineCheckbox11" value="1皇冠"> 1皇冠
                      </label>
                      <label class="checkbox-inline">
                        <input type="checkbox" id="inlineCheckbox12" value="2皇冠"> 2皇冠
                      </label>
                      <label class="checkbox-inline">
                        <input type="checkbox" id="inlineCheckbox13" value="3皇冠"> 3皇冠
                      </label>
                      <label class="checkbox-inline">
                        <input type="checkbox" id="inlineCheckbox14" value="4皇冠"> 4皇冠
                      </label>
                      <label class="checkbox-inline">
                        <input type="checkbox" id="inlineCheckbox15" value="5皇冠"> 5皇冠
                      </label>
                      <label class="checkbox-inline">
                        <input type="checkbox" id="inlineCheckbox16" value="1金冠"> 1金冠
                      </label>
                      <label class="checkbox-inline">
                        <input type="checkbox" id="inlineCheckbox17" value="2金冠"> 2金冠
                      </label>
                      <label class="checkbox-inline">
                        <input type="checkbox" id="inlineCheckbox18" value="3金冠"> 3金冠
                      </label>
                      <label class="checkbox-inline">
                        <input type="checkbox" id="inlineCheckbox19" value="4金冠"> 4金冠
                      </label>
                      <label class="checkbox-inline">
                        <input type="checkbox" id="inlineCheckbox20" value="5金冠"> 5金冠
                      </label>
                    </div>
                  </div>

                  <div class="form-group" style="text-align:center;">
                    <button type="button" class="btn btn-sm btn-primary second-Filt">二次筛选</button>
                  </div>

                  

                  <div class="divider"></div>

                  <h3 class="label label-info">预选商品价格分布及数量</h3>

                  <div class="form-group" style="text-align:center">
                    <img src="http://placehold.it/700x300" alt="">
                  </div>

                  <div class="divider"></div>

                  <h3 class="label label-info">预选商品商家星级分布及数量</h3>
                  
                  <div class="form-group" style="text-align:center">
                    <img src="http://placehold.it/700x300" alt="">
                  </div>

                  <div class="divider"></div>

                  <h3 class="label label-info">内容预览区</h3>

                  <ul class="pre-item form-group">

                  </ul>

                  <div class="flip-btn">
                    <button type="button" class="flip-more btn btn-sm btn-primary">查看更多</button>
                    <span href="" class="page-now" style="display:none"></span>
                    <span href="" class="totalnum" style="display:none">100</span>
                  </div>

                  <div class="save">
                    <button type="button" class="btn btn-sm btn-success btn-save">保存算法</button>
                  </div>
                </form>
              </div>
            </div>
          </div>
        </div>
      </div>
    </div>


  <script>
    var preview = (function(){

      var QUERY_URL = 'http://10.125.203.32:8080/tboverseas/item/queryList.htm',
          ADD_URL = 'http://10.125.203.32:8080/tboverseas/item/add.htm',
          CONFIG_URL = 'http://10.125.203.32:8080/tboverseas/config/add.htm';


      var application = {
        init : function(){
          this.LoadItemList('get',QUERY_URL,1,0,0);
          this.BindClick();
        },
        LoadItemList : function(type,url,page,price,level){

          var parameter = this.ReadLocalData()[0];

          if(page){
            parameter['pageNum'] = page;
          }
          
          if(price){
            parameter['itemPrice'] = price;
          }
          if(level){
            parameter['sellerLevel'] = level;
          }
          
          parameter['moduleId'] = 12345;
          parameter['totalNum'] = $('.totalnum').html();
          parameter['pageSize'] = 16;
          parameter['submitflag'] = 1;

          $.ajax({
            type : type,
            url : url,
            data : parameter,
            dataType : "jsonp",
            success: function(data){
              var dataList = data.itemInfoList.dataList;
              var pagenow = data.itemInfoList.currentPageNum;
              var total = data.itemInfoList.total;

              $.each(dataList,function(key,value){

                value.mainPic = value.mainPic+'_240x240.jpg';

                var deleted = value.status == 0 ? '' : 'deleted';

                var itemcon = '<li data-id="'+ value.itemId +'" data-seller="'+ value.sellerId +'" class="'+ deleted +'"><a href=""><img src="'+ value.mainPic +'" alt=""><span>'+ value.title +'</span></a><span class="mask"></span></li>';


              $('.pre-item').append(itemcon);

              });

              //当前页码
              $('.page-now').html(pagenow);

              //当前数据最大值
              $('.totalnum').html(total);
              
            }
          })
        },
        ReadLocalData : function(){
          var preview_data = JSON.parse(localStorage.getItem("causeway"));
          
          return preview_data;
        },
        BindClick : function(){
          var self = this;

          $( "body" ).delegate( ".mask", "click", function( event ) {

            var parent = $(this).parent('li')[0];

            if($(parent).hasClass('deleted')) return;

            var sellerId = $(parent).attr('data-seller');
            var itemId = $(parent).attr('data-id');

            //打点统计
            var src= ADD_URL+'?userId='+ sellerId +'&itemId='+ itemId +'&reason='+$.now();
          
            RequestOnce(src);

            $(parent).addClass('deleted');

          });

          $( "body" ).delegate( ".flip-more", "click", function( event ) {
            
            var page = parseInt($('.page-now').html())+1;

            var second = CheckSecondFilt();
            
            self.LoadItemList('GET',QUERY_URL,page,second.price,second.checked);

            event.preventDefault();
          });

          $('body').delegate('.second-Filt','click',function(event){
            
            var second = CheckSecondFilt();

            //empty
            $('.pre-item').empty();

            self.LoadItemList('GET',QUERY_URL,1,second.price,second.checked);

          });

          $('body').delegate('.btn-save','click',function(event){

            var second = CheckSecondFilt();

            self.LoadItemList('POST',CONFIG_URL,0,second.price,second.checked);
          });

          function CheckSecondFilt(){

            var pricemin = $('#pricemin').val() || '*';
            var pricemax = $('#pricemax').val() || '*';

            var price = pricemin + '-' + pricemax;
            
            var checkbox = $('.checkbox-inline input');

            var checked = [];

            $(checkbox).each(function(){
              
              if($(this)[0].checked){
                checked.push($(this)[0].value);
              }
              
            });

            checked = checked.join(',');


            var query = {
              price: price,
              checked : checked
            }

            return query;

          }

          function RequestOnce(src){

            //打点统计
            var img = new Image();
            var rnd_id = "_img_" + Math.random();
            window[rnd_id] = img; // 全局变量引用
            img.onload = img.onerror = function () {
                window[rnd_id] = null; // 删除全局变量引用
            }
            img.src = src;
          }

        }
      }

      return application;
    })()

    preview.init();



  </script>  
  </body>
</html>